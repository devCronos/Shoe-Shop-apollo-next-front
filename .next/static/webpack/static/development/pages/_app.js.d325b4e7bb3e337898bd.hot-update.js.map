{"version":3,"file":"static/webpack/static\\development\\pages\\_app.js.d325b4e7bb3e337898bd.hot-update.js","sources":["webpack:///./components/TakeMyMoney.js"],"sourcesContent":["import React from 'react';\nimport StripeCheckout from 'react-stripe-checkout';\nimport {Mutation} from 'react-apollo';\nimport Router from 'next/router';\nimport NProgress from 'nprogress';\nimport gql from 'graphql-tag';\nimport calcTotalPrice from '../lib/calcTotalPrice';\nimport Error from './ErrorMessage';\nimport User, {CURRENT_USER_QUERY} from './User';\n\nconst CREATE_ORDER_MUTATION = gql`\n    mutation CREATE_ORDER_MUTATION($token: String!){\n        createOrder(token: $token) {\n            id\n            charge\n            total\n            items{\n                id\n                title\n            }\n        }\n    }\n`;\n\nfunction totalItems(cart) {\n    return cart.reduce((acum, cartItem) => acum + cartItem.quantity, 0)\n}\n\nclass TakeMyMoney extends React.Component{\n    onToken = async (res, craeteOrder) => {\n        console.log(res.id);\n        const order = await craeteOrder({\n            variables: {\n                token: res.id\n            }\n        }).catch(err=>alert(err.message));\n        console.log(order);\n    }\n\n    render(){\n        return(\n        <User>{({data: {me}})=>(\n            <Mutation mutation={CREATE_ORDER_MUTATION} refetchQueries={[{query: CURRENT_USER_QUERY}]}>\n            {(createOrder)=>(\n\n                <StripeCheckout\n                amount={calcTotalPrice(me.cart)}\n                name=\"Sick Fits\"\n                description={`Order of ${totalItems(me.cart)} items`}\n                image={me.cart.length && me.cart[0].item && me.cart[0].item.image}\n                stripeKey=\"pk_test_jwVfTHCtzqmxdvdMxhKaecQc006VADtbx6\"\n                currency=\"USD\"\n                email={me.email}\n                token={res => this.onToken(res, createOrder)}\n                >{this.props.children} </StripeCheckout>\n            )}\n            </Mutation>\n        )}</User>\n        )\n    }\n}\n\nexport default TakeMyMoney;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAaA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAGA;AACA;AADA;AADA;AAIA;AAAA;AACA;AAPA;AAEA;AAKA;AACA;AARA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;AASA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AARA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;AAFA;AAkBA;;;;AA/BA;AACA;AAiCA;;;;A","sourceRoot":""}